ext {
  springConfigLocation = System.getProperty('spring.config.location', "${System.getProperty('user.home')}/.spinnaker/")
}

apply plugin: 'spinnaker.application'

run {
  systemProperty('spring.config.location', project.springConfigLocation)
}

mainClassName = 'com.netflix.spinnaker.igor.Main'

dependencies {
    spinnaker.group "test"
    spinnaker.group "jackson"
    spinnaker.group "retrofitDefault"

    compile spinnaker.dependency("kork")
    compile spinnaker.dependency("korkStackdriver")
    compile spinnaker.dependency("korkWeb")
    compile spinnaker.dependency("korkJedis")
    compile spinnaker.dependency("korkDynomite")
    compile spinnaker.dependency("korkTelemetry")
    compile spinnaker.dependency("jacksonJsr310")
    compile spinnaker.dependency("groovy")
    compile spinnaker.dependency("rxJava")
    compile spinnaker.dependency("retrofit")
    compile spinnaker.dependency("eurekaClient")
    compile spinnaker.dependency("korkHystrix")
    compile spinnaker.dependency("okHttp")
    compile spinnaker.dependency('logstashEncoder')
    compile spinnaker.dependency("yaml")

    compile spinnaker.dependency("gson")
    compile 'com.squareup.retrofit:converter-simplexml:1.9.0'
    compile "com.fasterxml.jackson.dataformat:jackson-dataformat-xml:${spinnaker.version("jackson")}"

    runtime "org.springframework.boot:spring-boot-properties-migrator:${spinnaker.version("springBoot")}"

    testCompile 'com.squareup.okhttp:mockwebserver:2.7.0'
    testCompile spinnaker.dependency("korkJedisTest")
}

configurations.all {
    resolutionStrategy {
        force 'org.apache.log4j:log4j:2.11.2'
        force 'commons-codec:commons-codec:1.11'
    }
    exclude group: 'javax.servlet', module: 'servlet-api'
    exclude group: "org.slf4j", module: "slf4j-log4j12"
    exclude group: "org.mortbay.jetty", module: "servlet-api"
}

jar {
    enabled = true
}

bootJar {
    mainClassName = "com.netflix.spinnaker.igor.Main"
}
